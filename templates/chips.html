<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Chips</title>
    <link rel="stylesheet" href="chip.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="chip-header">
        <div class="container">
            <div class="chip-header-content">
                <div class="icon-wrapper">
                    <i class="fas fa-sim-card"></i>
                </div>
                <div class="header-text">
                    <h1 class="chip-title">Gestão de Chips</h1>
                    <p class="chip-subtitle">Cadastro, edição e monitoramento em tempo real</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container chip-container">
        <!-- Form Card -->
        <section class="chip-card">
            <div class="chip-card-header">
                <div class="card-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <h2 class="card-title">Novo Chip</h2>
            </div>
            <div class="card-content">
                <form id="chipForm" class="chip-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_chip">ID do Chip *</label>
                            <input type="text" id="id_chip" name="id_chip" placeholder="Ex: CHIP-001" required>
                        </div>

                        <div class="form-group">
                            <label for="numero">Número *</label>
                            <input type="text" id="numero" name="numero" placeholder="5511999999999" required>
                        </div>

                        <div class="form-group">
                            <label for="operadora">Operadora</label>
                            <select id="operadora" name="operadora">
                                <option value="VIVO">VIVO</option>
                                <option value="TIM">TIM</option>
                                <option value="CLARO">CLARO</option>
                                <option value="OI">OI</option>
                                <option value="OUTRA">OUTRA</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status">
                                <option value="DISPONIVEL">DISPONÍVEL</option>
                                <option value="MATURANDO">MATURANDO</option>
                                <option value="MATURADO">MATURADO</option>
                                <option value="DESCANSO_1">DESCANSO 1</option>
                                <option value="DESCANSO_2">DESCANSO 2</option>
                                <option value="PRONTO_PARA_MATURAR">PRONTO PARA MATURAR</option>
                                <option value="DISPARANDO">DISPARANDO</option>
                                <option value="BANIDO">BANIDO</option>
                                <option value="RESTRINGIDO">RESTRINGIDO</option>
                                <option value="ATIVO">ATIVO</option>
                                <option value="BLOQUEADO">BLOQUEADO</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="plano">Plano</label>
                            <input type="text" id="plano" name="plano" placeholder="Ex: Controle 50GB">
                        </div>

                        <div class="form-group">
                            <label for="dt_inicio">Data de Início</label>
                            <input type="date" id="dt_inicio" name="dt_inicio">
                        </div>

                        <div class="form-group">
                            <label for="ultima_recarga_valor">Valor Última Recarga (R$)</label>
                            <input type="number" id="ultima_recarga_valor" name="ultima_recarga_valor" step="0.01" placeholder="0.00">
                        </div>

                        <div class="form-group">
                            <label for="ultima_recarga_data">Data Última Recarga</label>
                            <input type="date" id="ultima_recarga_data" name="ultima_recarga_data">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="total_gasto">Total Gasto (R$)</label>
                            <input type="number" id="total_gasto" name="total_gasto" step="0.01" placeholder="0.00">
                        </div>

                        <div class="form-group full">
                            <label for="sk_aparelho_atual">Aparelho Vinculado</label>
                            <select id="sk_aparelho_atual" name="sk_aparelho_atual">
                                <option value="">— Nenhum —</option>
                                <option value="samsung_s21">Samsung Galaxy S21</option>
                                <option value="samsung_s22">Samsung Galaxy S22</option>
                                <option value="iphone_13">iPhone 13</option>
                                <option value="iphone_14">iPhone 14</option>
                                <option value="xiaomi_note_11">Xiaomi Redmi Note 11</option>
                                <option value="motorola_g100">Motorola Moto G100</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="chip-btn">
                        <i class="fas fa-plus"></i>
                        Cadastrar Chip
                    </button>
                </form>
            </div>
        </section>

        <!-- Table Card -->
        <section class="chip-card">
            <div class="chip-card-header">
                <div class="card-icon">
                    <i class="fas fa-list"></i>
                </div>
                <h2 class="card-title">Chips Cadastrados</h2>
            </div>
            <div class="card-content">
                <div class="search-wrapper">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" class="search-input" placeholder="Buscar chips...">
                </div>
                <div class="chip-table-wrapper">
                    <table class="chip-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Número</th>
                                <th>Operadora</th>
                                <th>Status</th>
                                <th>Plano</th>
                                <th>Últ. Recarga</th>
                                <th>Valor (R$)</th>
                                <th>Total Gasto (R$)</th>
                                <th>Aparelho</th>
                                <th>Data Início</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Dados serão inseridos aqui via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>Sistema de Gestão de Chips - <span id="currentYear"></span></p>
        </div>
    </footer>

    <script>
        // Array para armazenar os chips
        let chips = [];

        // Função para formatar moeda
        function formatCurrency(value) {
            if (!value) return '-';
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        // Função para formatar data
        function formatDate(date) {
            if (!date) return '-';
            return new Date(date + 'T00:00:00').toLocaleDateString('pt-BR');
        }

        // Função para obter cor do status
        function getStatusColor(status) {
            const colors = {
                'DISPONIVEL': 'status-disponivel',
                'MATURANDO': 'status-maturando',
                'MATURADO': 'status-maturado',
                'DESCANSO_1': 'status-descanso_1',
                'DESCANSO_2': 'status-descanso_2',
                'PRONTO_PARA_MATURAR': 'status-pronto_para_maturar',
                'DISPARANDO': 'status-disparando',
                'BANIDO': 'status-banido',
                'RESTRINGIDO': 'status-restringido',
                'ATIVO': 'status-ativo',
                'BLOQUEADO': 'status-bloqueado'
            };
            return colors[status] || 'status-default';
        }

        // Função para renderizar a tabela
        function renderTable(data = chips) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" class="empty-message">Nenhum chip cadastrado ainda.</td></tr>';
                return;
            }

            data.forEach(chip => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${chip.id_chip}</td>
                    <td>${chip.numero}</td>
                    <td>${chip.operadora}</td>
                    <td><span class="status-badge ${getStatusColor(chip.status)}">${chip.status}</span></td>
                    <td>${chip.plano || '-'}</td>
                    <td>${formatDate(chip.ultima_recarga_data)}</td>
                    <td>${formatCurrency(chip.ultima_recarga_valor)}</td>
                    <td>${formatCurrency(chip.total_gasto)}</td>
                    <td>${chip.sk_aparelho_atual || '-'}</td>
                    <td>${formatDate(chip.dt_inicio)}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Função para adicionar chip
        document.getElementById('chipForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(e.target);
            const chip = {
                id_chip: formData.get('id_chip'),
                numero: formData.get('numero'),
                operadora: formData.get('operadora'),
                plano: formData.get('plano'),
                status: formData.get('status'),
                dt_inicio: formData.get('dt_inicio'),
                ultima_recarga_valor: formData.get('ultima_recarga_valor'),
                ultima_recarga_data: formData.get('ultima_recarga_data'),
                total_gasto: formData.get('total_gasto'),
                sk_aparelho_atual: formData.get('sk_aparelho_atual')
            };

            chips.push(chip);
            renderTable();
            e.target.reset();
            
            // Mostrar mensagem de sucesso (opcional)
            alert('Chip cadastrado com sucesso!');
        });

        // Função de busca
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const filtered = chips.filter(chip => {
                return Object.values(chip).some(value => 
                    String(value).toLowerCase().includes(searchTerm)
                );
            });
            renderTable(filtered);
        });

        // Definir ano atual no footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Renderizar tabela inicial
        renderTable();
    </script>
</body>
</html>
