{% extends "base.html" %}
{% block conteudo %}

<h2>Registrar Evento</h2>

<form id="form-evento" class="form-box">

    <label>Chip</label>
    <select name="sk_chip">
        {% for c in chips %}
            <option value="{{ c.sk_chip }}">{{ c.numero }}</option>
        {% endfor %}
    </select>

    <label>Aparelho</label>
    <select name="sk_aparelho">
        {% for a in aparelhos %}
            <option value="{{ a.sk_aparelho }}">{{ a.modelo }}</option>
        {% endfor %}
    </select>

    <label>Tipo de Movimento</label>
    <select name="tipo_movimento">
        <option>ENTREGA</option>
        <option>DEVOLUÇÃO</option>
        <option>RECARGA</option>
    </select>

    <label>Data</label>
    <input type="date" name="data_uso">

    <label>Origem</label>
    <input name="origem">

    <label>Observação</label>
    <input name="observacao">

    <button>Salvar Evento</button>
</form>

<h2>Eventos Registrados</h2>

<table class="tabela">
<thead>
<tr>
    <th>Chip</th>
    <th>Aparelho</th>
    <th>Tipo</th>
    <th>Data</th>
    <th>Origem</th>
    <th>Observação</th>
</tr>
</thead>
<tbody>
{% for r in rel %}
<tr>
    <td>{{ r.sk_chip }}</td>
    <td>{{ r.sk_aparelho }}</td>
    <td>{{ r.tipo_movimento }}</td>
    <td>{{ r.data_uso }}</td>
    <td>{{ r.origem }}</td>
    <td>{{ r.observacao }}</td>
</tr>
{% endfor %}
</tbody>
</table>

<script>
document.querySelector("#form-evento").onsubmit = async e => {
    e.preventDefault();
    await fetch("/eventos/add", {method:"POST", body:new URLSearchParams(new FormData(e.target))});
    location.reload();
};
</script>

{% endblock %}
